# 概述

视频点播支持通过多种方式上传媒体文件（音频、视频、图片等）到点播存储。同时支持自动触发或通过API，发起进行转码、剪辑、分发等后续处理。本文为您介绍视频点播支持的上传方式、文件格式和相关说明。

上传中用到的AccessKey以及权限配置等，请参见[账号与授权概述](/cn.zh-CN/开发指南/账号和授权/概述.md)。

点播服务还会下发**上传地址和凭证**，作为上传媒体文件到点播存储的授权凭证和文件地址。更多信息，请参见[上传地址和凭证](/cn.zh-CN/开发指南/媒体上传/上传地址和凭证.md)。

## 上传方式

阿里云视频点播支持如下几种方式上传媒体文件：

|方式|说明|适合场景|参考文档|
|--|--|----|----|
|控制台上传|提供音视频及图片上传功能，支持批量操作。开通点播服务后，使用浏览器登录控制台即可进行上传。|快速、便捷地将媒体资源上传到点播的场景。|[媒资上传](/cn.zh-CN/控制台指南/媒资库/媒资上传.md)|
|服务端上传|支持将存储在应用服务器上的媒体文件上传到点播，需要集成服务端上传SDK。|自动化上传、大批量迁移视频上传等场景。|[服务端上传](/cn.zh-CN/开发指南/媒体上传/服务端上传.md)|
|客户端上传|终端（移动端、PC Web端）用户将客户端本地媒体文件上传到点播，需要集成客户端上传SDK。当前支持：-   Android上传SDK
-   iOS上传SDK
-   Web端上传SDK

|UGC、PGC等场景。|[客户端上传](/cn.zh-CN/开发指南/媒体上传/客户端上传.md)|
|离线拉取上传|支持将其它地方存储的媒体文件离线拉取上传到点播，可调用UploadMediaByURL接口，指定要上传的媒体URL列表，点播服务会在后台自动拉取源站文件进行上传。|文件存储在其它地方的场景。|[URL批量拉取上传](/cn.zh-CN/服务端API/媒体上传/URL批量拉取上传.md)|
|PC客户端工具上传|支持在电脑上使用客户端工具进行上传，需要下载并安装点播客户端工具，目前支持Windows、Mac。 **说明：** 控制台由于安全策略，长时间上传可能会登录失效导致大文件上传失败，PC客户端工具能有效避免此问题。

|大文件、长时间上传，以及低门槛的运营场景。|下载链接：-   [点播客户端工具（Windows）](https://alivc-demo-cms.alicdn.com/versionProduct/installPackage/upload/ApsaraVideo_vodClient_v1.0.0_Windows_20201023.zip)
-   [点播客户端工具（MacOS）](https://player.alicdn.com/download/aliyun_video_client_1.3.2_1024.dmg?spm=a2c4g.11186623.2.22.515927b0580YmN&file=aliyun_video_client_1.3.2_1024.dmg) |

**说明：**

-   控制台、上传SDK、上传工具等默认使用分片上传，最大支持48.8TB的单个文件；上传SDK同时也提供简单上传功能，最大支持5GB的单个文件。
-   支持断点续传。
-   使用分片上传时，若上传失败则可能会产生碎片文件，一般7天后会自动清除。

## 支持格式

|媒体类型|支持文件格式|
|----|------|
|视频|-   MPEG格式：MP4、TS、3GP、MPG、MPEG、MPE、DAT、VOB、ASF等。
-   AVI格式：AVI。
-   Windows Media Video格式：WMV、ASF。
-   Flash Video格式：FLV、F4V。
-   Real Video格式：RM、RMVB。
-   QuickTime格式：MOV。
-   Matroska格式：MKV。
-   HLS格式：M3U8。
-   其它格式：DV、GIF、M2T、M4V、MJ2、MJPEG、MTS、OGG、QT、SWF、WEBM。 |
|音频|MP3、WMA、WAV、AAC、RA、M4A、FLAC、APE、AC3、AMR、CAF、ACM。|
|图片|PNG、JPG、JPEG、GIF。|
|辅助媒资|-   水印文件：PNG、GIF、APNG、MOV。
-   字幕文件：SRT、ASS、STL、TTML、VTT。
-   素材文件：JPG、GIF、PNG、MP4、MAT、ZIP。 |

**说明：** 文件扩展名大小写都支持，如MP4和mp4等同。

## 上传相关说明

-   **存储说明**
    -   点播基于阿里云OSS提供媒体资源存储服务，无需单独开通OSS即可使用。开通点播服务时会默认分配系统Bucket（一般位于华东2-上海），还可添加其它地域的存储。更多信息，请参见[存储管理](/cn.zh-CN/控制台指南/配置管理/存储管理.md)。
    -   您可使用全局的默认存储，也可在每个视频上传时指定存储地址。为确保上传的媒体文件不会互相覆盖，上传后的文件存储路径为系统指定。上传后可查看媒体文件，进行获取信息、更新信息、搜索、下载和删除等媒资管理操作。更多信息，请参见[媒资管理](/cn.zh-CN/控制台指南/媒资库/媒资管理.md)。
    -   存储空间支持按量付费和预购资源包两种计费方式。更多信息，请参见[媒资管理定价](https://www.aliyun.com/price/detail/vod#module3)和[视频点播存储包](https://common-buy.aliyun.com/?spm=5176.8296044.671734.pricedetail2222.5c22435bMzdW0P&commodityCode=vodstoragebag#/buy)。
-   **附加设置**

    上传媒体文件时还可支持以下设置：

    -   设置元数据：如音视频/图片的标题、分类、标签等；用于后续媒资管理和搜索。
    -   指定存储地址：即上传SDK/API的`StorageLocation`参数；默认使用全局默认存储。
    -   指定事件通知的方式和地址：即上传SDK/API的[UserData](/cn.zh-CN/服务端API/附录/请求参数说明.md)参数的`MessageCallback`字段；默认使用全局回调设置。
    -   指定视频处理方式：视频上传完成后，点播服务会默认截取封面图，同时会按照指定的处理方式进行后续处理。
        -   可指定使用的转码模板组 `TemplateGroupId`，或者指定不转码（即 `不转码即分发` 模板），如果不指定转码模板组，则默认使用全局转码设置。
        -   也可指定使用工作流WorkFlowId方式进行处理，视频在上传完成后，会自动执行指定的工作流。
    **说明：** 上传的附加设置参数，请参见[媒体上传API](/cn.zh-CN/服务端API/API概览.md)。

-   **加速功能**

    点播服务提供上传加速的功能，以提升远距离（如跨海等情况）文件传输和GB、TB级大文件的上传性能。

    -   开通方式：[提交工单](https://selfservice.console.aliyun.com/ticket/category/vod/recommend/561)到点播申请开通，需要提供**主账号UID**和需要使用上传加速的**存储地址**。
    -   使用方式：需要在上传SDK/API的[UserData](/cn.zh-CN/服务端API/附录/请求参数说明.md)参数中指定`AccelerateConfig`字段（JSON字符串）进行上传加速的设置。
    -   使用说明：上传加速仅对单次上传生效，如果本次上传需要使用上传加速，则上传时需设置上传加速参数，反之，则不使用上传加速。
    -   上传加速按使用情况收费，只开通不使用不收费。详细价格请参见[阿里云产品定价](https://www.aliyun.com/price/product?#/vod/detail)。
    上传加速参数示例：

    -   取值示例：`{"Type":"oss","Domain":"https://oss-accelerate.aliyuncs.com"}`，其中 ：
        -   Type：加速方式，仅支持oss。
        -   Domain：加速域名，对应oss的[传输加速Endpoint](https://help.aliyun.com/document_detail/31837.html#concept-zt4-cvy-5db)，默认为https。
    -   上传加速参数设置可参考以下UserData构建示例：

        ```
            public static String buildUserdata() {
        
                JSONObject userData = new JSONObject();
                //上传加速参数配置（需要使用上传加速服务时设置）
                JSONObject accelerateConfig = new JSONObject();
                accelerateConfig.put("Type", "oss");
                accelerateConfig.put("Domain", "https://oss-accelerate.aliyuncs.com");
                userData.put("AccelerateConfig", accelerateConfig);
                
                return userData.toJSONString();
            }
        ```

-   **上传转码设置**

    在上传视频时可指定转码方式或不转码，比如在短视频场景下，由于已在端上实现了视频的录制和编码压缩，可以选择云端不转码，配置请参见[转码设置](/cn.zh-CN/控制台指南/配置管理/转码设置.md)。

    -   快速转码：为点播的默认处理方式，上传视频完成后会自动触发转码。
    -   不转码即分发：设置不转码后视频上传完成即可进行播放，如果配置了[点播加速域名](/cn.zh-CN/控制台指南/域名管理/添加加速域名.md)，则会默认对上传的视频进行分发加速，确保播放的流畅度。

## 事件通知

在媒体文件上传完成后，可以实时获取到事件通知。但前提是需要先部署事件通知的接收服务，并将服务地址配置到点播控制台，参考[事件通知概述](/cn.zh-CN/开发指南/事件通知/概述.md)。上传完成消息有：

-   [视频上传完成](/cn.zh-CN/开发指南/事件通知/事件列表/视频上传完成.md)（含音频）
-   [图片上传完成](/cn.zh-CN/开发指南/事件通知/事件列表/图片上传完成.md)

## 上传后相关说明

-   **上传后的处理**

    视频点播支持媒体文件上传后的音视频转码、智能审核、云剪辑、AI处理等。

    与OSS不同的是，上传到点播存储的音视频文件会默认提取Meta信息（如视频分辨率、时长、码率等），对视频也会默认截取封面图，且这部分预处理完全免费。

-   **媒资管理**

    上传完成后，可使用点播服务管理媒体文件，如视频源文件、转码后的流文件、图片文件等。有如下两种方式可进行媒资管理：

    -   在控制台的媒资库页面进行媒资管理。具体操作，请参见[媒资管理](/cn.zh-CN/控制台指南/媒资库/媒资管理.md)。
    -   通过媒资管理接口进行相关操作，更多信息，请参见[媒资管理接口](/cn.zh-CN/服务端API/API概览.md)。
    **说明：** 更多信息可参考[媒资管理概述](/cn.zh-CN/开发指南/媒资管理/概述.md)，其中详细说明了如何查询、搜索和更新媒资信息，以及如何[下载媒体文件](/cn.zh-CN/开发指南/媒资管理/下载媒体文件.md)、[删除媒体文件](/cn.zh-CN/开发指南/媒资管理/删除媒体文件.md)。

-   **播放条件**

    用户上传视频完成后，并不代表视频已准备就绪，还需点播服务端确认接收完成，可根据`事件通知`来确定上传的视频何时能播放。

    -   对于不转码的视频\(或音频\) 接收到[视频上传完成](/cn.zh-CN/开发指南/事件通知/事件列表/视频上传完成.md)的事件通知后即可进行播放，此时可通过[获取视频播放地址](/cn.zh-CN/服务端API/音视频播放/获取视频播放地址.md)接口获取到播放地址。
    -   对于转码的视频，接收到[单个清晰度转码完成](/cn.zh-CN/开发指南/事件通知/事件列表/单个清晰度转码完成.md)事件通知即可进行播放，若要确保所有清晰度都能获取到，可接收到[视频转码完成](/cn.zh-CN/开发指南/事件通知/事件列表/视频转码完成.md)事件通知再处理。
    当然，您也可以设置不转码，接收到[视频上传完成](/cn.zh-CN/开发指南/事件通知/事件列表/视频上传完成.md)事件通知后，再调用[提交媒体转码作业](/cn.zh-CN/服务端API/媒体处理/发起处理/提交媒体转码作业.md)、[提交媒体截图作业](/cn.zh-CN/服务端API/媒体处理/发起处理/提交媒体截图作业.md)，或[提交智能审核作业](/cn.zh-CN/服务端API/媒体审核/智能审核/提交智能审核作业.md)等接口进行相应处理。


