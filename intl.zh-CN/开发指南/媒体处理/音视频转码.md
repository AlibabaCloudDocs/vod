音视频转码 
==========================

转码是媒体处理中重要的一步，本文为您介绍转码的简介，如何通过上传自动触发方式、控制台、API发起转码，以及不转码，并为您详细介绍转码模板的参数和窄带高清^TM^1.0。

转码简介 
-------------------------

**什么是转码** 

视频转码（Video Transcoding）是指将已经压缩编码的视频码流转换成另一个视频码流，以适应不同的网络带宽、不同的终端处理能力和不同的用户需求。转码本质上是一个先解码、再编码的过程，因此转换前后的码流可能遵循相同的视频编码标准，也可能不遵循相同的视频编码标准。

转码在视频生产流程中的位置如下：

![流程](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/0053216061/p180475.png)

**点播转码功能特性** 

* 视频处理：完善的[转码](~~99380~~)与[转封装](~~99380~~)能力，进行丰富的媒体格式转换。

  

* 音频处理：音频转码、音频抽取等。

  

* 水印：支持静态图片水印、动态图片水印(如gif、mov等))和文字水印，并且支持多水印添加。更多信息，请参见[视频水印](/intl.zh-CN/开发指南/媒体处理/视频水印.md)。

  

* 多清晰度预置：标清、高清、超高、2k、4k等多个预置清晰度，提供最佳经验值，降低接入门槛。

  

* 音频抽取等多场景解决方案：客户可在视频中提取一路普通音质、高音质等作为音频输出，如电台等场景。

  

* 内容保护：内容加密，适用于在线教育、原创保护等多种场景。

  




**使用场景** 

* 多终端设备适配：适配PC、TV以及移动终端等多平台播放。

  

* 多种网络环境适配：多种网络环境适配：不同网络带宽的用户选择最佳码率，流畅播放

  

* 降低存储、分发成本： 保证在相同画质质量的前提下，调整视频码率、提高视频压缩率、减小文件体积，从而减少播放卡顿并节省存储和流量费用。

  

* 内容保护：为内容保护提供了有效的支持，适用于在线教育、原创保护等多种场景

  

* 水印添加：在视频上添加企业Logo、电视台台标、用户ID或昵称等标志性信息，用于品牌宣传或者宣示当前视频的版权归属。

  




点播基于长期的数据分析，进行多种清晰度场景化的预设配置，提供从上传到转码一体化的流程处理。

**不转码的情况** 

* 在短视频等场景下，视频通常已在端上进行过拍摄和压缩，已经具备多终端播放的能力。此时可以不进行转码。

  

* 如果用户已经自己在本地进行过转码操作，不需要依赖点播的转码进行二次处理，也可以选择不转码。

  




窄带高清 
-------------------------

窄带高清^TM^1.0，基于阿里云独家转码技术，对视频中每个场景、动作、内容、纹理等进行智能分析，保证相同视频画质下，码率更低，一定程度上降低带宽成本。可通过[云栖社区](https://yq.aliyun.com/articles/73018)了解更多内容。

点播预置了多种窄带高清清晰度，支持MP4、FLV、HLS格式，具体参数如下：


| 清晰度 | 码率范围  | 分辨率-宽 |
|-----|-------|-------|
| 流畅  | ≤400  | 640   |
| 标清  | ≤800  | 848   |
| 高清  | ≤1500 | 1280  |
| 超清  | ≤3000 | 1920  |
| 2K  | ≤4000 | 2048  |
| 4K  | ≤8000 | 3840  |



**配置方式：** 

请参见[添加转码配置](/intl.zh-CN/服务端API/媒体处理/转码模板/创建转码模板组.md)，指定预置清晰度进行配置。
**说明**

窄带高清的收费方式与普通转码存在差异，详情请参见[视频转码](/intl.zh-CN/产品定价/计费概述/按量计费.md)。

发起转码方式 
---------------------------

* 通过上传自动触发方式转码

  * 用户可以直接操作控制台进行上传，在上传前选择转码模板。具体操作，请参见[媒资上传](/intl.zh-CN/控制台指南/媒资库/媒资上传.md)。![](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3696325061/p178278.png)

    
  
  * 用户也可在获取上传凭证时指定所使用的转码模板ID，上传完成后点播系统会自动根据所指定的模板进行转码，并且会根据用户配置的回调，将转码后的信息回调给用户。更多信息，请参见[媒体上传](/intl.zh-CN/开发指南/媒体上传/概述.md)。

    
  

  

* 通过控制台发起转码

  用户可通过控制台对已有视频发起转码，该操作常用于对已有视频的重转码。
  1. 在视频列表页面，单击需要操作的视频右侧的 **更多** 按钮，选择媒体处理。![](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3696325061/p178279.png)

     
  
  2. 选择需要使用的转码模板组，单击 **确定** ，即可触发转码。![转码](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3696325061/p180483.png)

     
  

  

* 通过API发起转码

  用户还可以通过调用[提交媒体转码作业](/intl.zh-CN/服务端API/媒体处理/发起处理/提交媒体转码作业.md)接口的方式，指定所使用的转码模板，手动发起转码操作。该操作常用于对已有视频的重转码、标准加密、水印参数覆盖等。
  

* 不转码

  用户还可以指定使用 **不转码即分发** 模板进行上传，此时不会发起转码。并且，点播会将原始视频写入播放列表，用户在获取播放信息时，可以获取到该播放地址，常用于短视频等场景。
  




转码模板 
-------------------------

转码参数十分复杂，为了避免用户将过多精力集放在参数管理，点播系统将这一系列复杂参数保存为模板。用户可自行定义转码模版，它是转码参数（音频、视频、容器等）的集合，可以满足用户个性化的转码需求。一个转码模板可包含多路输出，同时，点播根据视频清晰度、音频音质等不同，提供了一系列的参数建议值，方便用户低门槛、快速使用。

进入控制台 **[添加转码模板组](https://vod.console.aliyun.com/#/settings/transcode/add)** 页面，即可看见如下页面：![转码模板 ](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9063155061/p182466.png)

**转码模板详解：** 

目前，点播系统预置了流畅、标清、高清、超清、2K、4K、原画共7种清晰度，以及普通音质、高音质两档音质，并且为每种清晰度提供了推荐的参数，当用户在控制台勾选所指定清晰度时，会自动填充系统推荐值，便于用户快速接入。
**说明**

详细参数解释可参见[词汇表](/intl.zh-CN/产品简介/基本概念.md)。

转码模板的参数如下表所示：


| 序号 |        参数分类        |  参数名称   |                                                                                             描述                                                                                              |
|----|--------------------|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1  | 基本参数               | 封装格式    | * 视频支持：HLS、MP4、FLV。   * 音频支持：MP3。    各种封装格式的具体介绍请参见[词汇表-封装格式](/intl.zh-CN/产品简介/基本概念.md)。 |
| 1  | 基本参数               | 清晰度     | * 清晰度：流畅、标清、高清、超清、2K、4K、原画（转封装）。   * 音质：普通音质、高音质。                                                        |
| 2  | 视频参数               | 禁用视频    | 禁用视频后，转码后输出流不包含视频（常用与提取一路输出作为音频，如电台场景）。                                                                                                                                                     |
| 2  | 视频参数               | 编码格式    | 目前支持H.264、H.265。                                                                                                                                                                            |
| 2  | 视频参数               | 码率      | 码率输入范围10Kbps\~50000Kbps，区分清晰度控制，建议按照各清晰度推荐码率设置。                                                                                                                                             |
| 2  | 视频参数               | 分辨率     | 分辨率宽高输入范围128Px\~4096Px，宽或高可只设置其中一项，另一边则按原始尺寸缩放。                                                                                                                                             |
| 2  | 视频参数               | 帧率      | 每秒显示帧数，建议按照各清晰度推荐帧率设置。                                                                                                                                                                      |
| 2  | 视频参数               | 关键帧最大间隔 | 一个 GOP 内的帧数，建议使用各清晰度推荐设置。                                                                                                                                                                   |
| 2  | 视频参数               | 水印设置    | 对视频进行加水印处理，需要在水印设置中添加素材并开启水印后生效。更多信息，请参见[视频水印](/intl.zh-CN/开发指南/媒体处理/视频水印.md)。                                                                                              |
| 3  | 音频参数               | 禁用音频    | 禁用音频后，转码后输出流不包含音频，如果需要输出画面无声音，可勾选此项。                                                                                                                                                        |
| 3  | 音频参数               | 编码格式    | 目前HLS和MP4封装格式支持AAC、MP3，MP3封装格式支持MP3。                                                                                                                                                        |
| 3  | 音频参数               | 采样率     | 建议使用推荐设置。                                                                                                                                                                                   |
| 3  | 音频参数               | 码率      | 音频码率输入范围8Kbps\~1000Kbps，建议使用推荐设置。                                                                                                                                                           |
| 3  | 音频参数               | 声道数     | 建议使用推荐设置。                                                                                                                                                                                   |
| 4  | 高级参数（当封装格式为HLS时存在） | 分片时长    | 每个ts分片的时长，建议使用推荐设置。                                                                                                                                                                         |
| 4  | 高级参数（当封装格式为HLS时存在） | HLS加密   | 目前可对HLS格式进行加密设置，选择 **加密** 后，需要集成官方支持视频解密的播放SDK版本完成播放。此服务试用期间免费。 **说明** 此处配置的加密为私有加密，如果要使用标准加密，请参见[提交媒体转码作业](/intl.zh-CN/服务端API/媒体处理/发起处理/提交媒体转码作业.md)接口。    |
| 5  | 条件转码参数             | 检查视频分辨率 | 检查输入分辨率是否小于转码模板设定的分辨率。                                                                                                                                                                      |
| 5  | 条件转码参数             | 检查视频码率  | 检查视频输入码率是否小于转码模板设定的码率。                                                                                                                                                                      |
| 5  | 条件转码参数             | 检查音频码率  | 检查音频输入码率是否小于转码模板设定的码率。                                                                                                                                                                      |



`条件转码参数`，常用于较高清晰度的设置。如用户设置4k清晰度，如果原片并未达到所设置的清晰度（分辨率），则会进行视频拉伸，影响视频效果。此时可使用条件转码。

目前支持两种处理方式：

* 如果转码模板的码率（或分辨率）比输入视频更高，则不进行该规格的视频转码。

  

* 如果转码模板的码率（或分辨率）比输入视频更高，则在进行该规格的转码时，输出码率（或分辨率）等于输入视频码率（或分辨率）

  




**不转码即分发模板：** 

点播存在这样一个特殊的模板------不转码。![](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/4696325061/p178287.png)

不转码的意思是，直接将原片作为视频流进行播放。使用此模板，点播会自动将原片进行分发，并写入视频流信息，方便用户在调用[获取视频播放地址](/intl.zh-CN/服务端API/音视频播放/获取视频播放地址.md)接口时，返回原片的地址进行播放该模板常用与短视频、直播转点播录制等场景，用户可直接播放原片。
**说明**

用户上传的原片需要可直接播放。

场景实践 
-------------------------

详情请参见最佳实践：[如何选择转码类型](/intl.zh-CN/最佳实践/如何选择转码类型.md)。
