视频水印 
=========================

视频点播提供视频添加水印功能，支持通过控制台和API管理水印，并在转码时添加水印。本文为您介绍添加水印的使用说明、水印管理、水印类型、位置参数和使用场景。

简介 
-----------------------

视频添加水印，即指在视频的编解码过程中将图片、文字等信息压制到视频流中合并输出一个带图文水印的新的视频文件。通常在视频上添加企业、品牌Logo、电视台台标、用户ID或昵称等标志性信息，可用于宣示对视频的版权归属或品牌宣传。

**水印类型** 
-----------------------------

视频点播当前支持三种水印类型：静态图片、动态图片和文字水印。

* 静图水印

  目前仅支持PNG格式，图片位于视频特定位置从片头展示到片尾，也可设置图片在视频时长内的某段时间展示（水印开始展示时间和水印结束展示时间）。

  适合对视频版权宣示或品牌宣传。
  




<!-- -->

* 动图水印

  目前支持GIF动图、APNG动图和MOV格式的视频，动态图片可在视频特定的位置从片头到片尾循环播放，也可设置动态图片在视频时长内的某段时间播放(水印开始展示时间和水印结束展示时间)。

  适合对视频版权宣示或品牌宣传。

  
  **说明**

  
  * 目前控制台仅支持GIF格式，API支持GIF、APNG和MOV格式。

    
  
  * 动态图片水印受文件扩展名限制，gif、apng和mov必须是小写，静态图片不受扩展名限制。

    
  
  * 水印文件存储源站必须与需要添加水印的视频存储源站一致。例如：存在华东2源站的视频，使用的水印文件必须存储在华东2的源站上，可不跨区域且暂不支持跨存储源站，存储源站请参见[存储管理](/intl.zh-CN/控制台指南/配置管理/存储管理.md)。

    
  

  
  




<!-- -->

* 文字水印

  用户可将特定的一段或多段文字压制到视频画面上作为水印，视频点播当前可支持用户设置文字的字体、字号、颜色、透明度、字体描边等效果，且支持不同视频压制不同的文字内容。动态文字水印详细请参见[提交媒体转码作业](/intl.zh-CN/服务端API/媒体处理/发起处理/提交媒体转码作业.md)。

  适合对视频版权宣示或品牌宣传，和短视频中文字动态替换。

  
  **说明**

  动图（MOV格式、APNG格式）水印和文字水印暂只支持通过水印接口进行管理，更多信息，请参见[添加水印](/intl.zh-CN/服务端API/媒体处理/视频水印/添加水印.md)接口。
  




使用说明 
-------------------------

视频水印的使用流程如下：

1. 添加并管理水印信息，请参见下文水印管理。

   

2. 设置默认水印，具体操作，请参见控制台[水印管理](/intl.zh-CN/控制台指南/配置管理/水印管理.md)或API[设置默认水印](/intl.zh-CN/服务端API/媒体处理/视频水印/设置默认水印.md)。

   

3. 创建转码模板并设置水印配置，具体操作，请参见控制台[转码设置](/intl.zh-CN/控制台指南/配置管理/转码设置.md)或API[添加转码配置](/intl.zh-CN/服务端API/媒体处理/转码模板/创建转码模板组.md)。

   

4. 使用刚创建好的水印模板上传视频，具体操作，请参见控制台[媒资上传](/intl.zh-CN/控制台指南/媒资库/媒资上传.md)或[媒体上传概述](/intl.zh-CN/开发指南/媒体上传/概述.md)。

   



**说明**



* 转码模板需要关联多个水印，请参考[添加转码配置](/intl.zh-CN/服务端API/媒体处理/转码模板/创建转码模板组.md)接口。

  

* 原画转码模板不支持水印勾选，对应输出视频流不能添加水印。

  




水印管理 
-------------------------

视频点播当前支持两种水印管理方式：视频点播水印管理控制台、水印管理接口。

* 控制台管理

  视频点播控制台支持水印管理的相关操作，请参见[水印管理](/intl.zh-CN/控制台指南/配置管理/水印管理.md)。
  **说明**

  视频点播控制台暂不支持mov、apng格式的动图水印文件上传，可通过[添加水印](/intl.zh-CN/服务端API/媒体处理/视频水印/添加水印.md)接口实现。
  




<!-- -->

* API管理

  添加水印模板可分为如下三个步骤：
  1. 调用CreateUploadAttachedMedia接口获取文件上传的路径以及临时授权。

     
  
  2. 使用OSS上传指定的水印文件，请参见[OSS文件上传](/intl.zh-CN/服务端API/媒体上传/OSS文件上传.md)。

     
  
  3. 调用[添加水印](/intl.zh-CN/服务端API/媒体处理/视频水印/添加水印.md)接口，添加水印信息。

     
  

  




水印位置参数 
---------------------------

水印位置参数是用于控制水印在输出视频画面中显示的位置、尺寸，可通过视频点播控制台或[添加水印](/intl.zh-CN/服务端API/媒体处理/视频水印/添加水印.md)接口设置水印参数。
**说明**

以下仅介绍控制水印位置及尺寸的参数示意。更多信息，请参见[水印配置 WatermarkConfig](/intl.zh-CN/服务端API/附录/媒体处理参数说明.md)。

* **图片水印** 

  可通过ReferPos、Dx、Dy、Width、Height控制图片在输出视频画面中的显示位置以及效果。
  

  |          API参数           | 控制台参数 |                                                                                                                               描述                                                                                                                               |
  |--------------------------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
  | ReferPos | 相对位置  | 水印相对输出视频画面的大概位置。 * 左上角：TopLeft   * 左下角：BottomLeft   * 右上角：TopRight   * 右下角：BottomRight    |
  | Dx                       | 水平偏移  | 水印在输出视频画面上水平偏移距离。取值： * 正整型：单位，像素；取值范围\[8，4096\]。   * 画面占比：单位，%；取值范围（0，1）。                                                                                   |
  | Dy                       | 垂直偏移  | 水印在输出视频画面上垂直偏移距离。取值： * 正整型：单位，像素；取值范围\[8，4096\]。   * 画面占比：单位，%；取值范围（0，1）。                                                                                   |
  | Width                    | 水印宽   | 水印在输出视频画面中显示的宽。取值： * 正整型：单位，像素；取值范围\[8，4096\]。   * 画面占比：单位，%；取值范围（0，1）。                                                                                     |
  | Height                   | 水印高   | 水印在输出视频画面中显示的高。取值： * 正整型：单位，像素；取值范围\[8，4096\]。   * 画面占比：单位，%；取值范围（0，1）。                                                                                     |
  | Timeline                 | 时间线   | 水印时间线用于控制图片水印在视频画面上的开始显示时间以及持续显示时间，可以通过多组水印配置控制图片水印在视频画面的动态显示效果。更多信息，请参见[水印时间线 Timeline](/intl.zh-CN/服务端API/附录/媒体处理参数说明.md)。 **注意** 文字水印暂不支持该参数。                                                                               |

  

  **示意图** 

  如需水印居中显示，则可按照画面占比设置Dx=0.5、Dy=0.5参数调整(水印的偏移位置为视频输出画面宽高的50%)。![图片水印位置](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9969155061/p178310.png)
  




<!-- -->

* **文字水印** 

  文字水印暂时只支持相对输出视频画面的左上角开始偏移，偏移参数为Top、Left，暂只支持像素取值，不支持画面占比类参数取值。
  

  | API参数 | 控制台参数 |                   描述                    |
  |-------|-------|-----------------------------------------|
  | Top   | 上边距   | 文字水印距离输出视频画面的上边距离。单位：像素，取值范围\[8，4096\]。 |
  | Left  | 左边距   | 文字水印距离输出视频画面的左边距离。单位：像素，取值范围\[8，4096\]。 |

  

  **示意图** ![文字水印](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9969155061/p178311.png)
  




<!-- -->

* **计算方式** 

  图片水印的Dx、Dy、Width、Height参数支持两种计算模式，文字水印的Top和Left只支持正整型取值，具体如下：
  * 正整型取值:单位:像素，取值范围\[8，4096\]。

    **注意**

    如果设置的参数超过视频输出画面的大小，则可能导致水印局部显示或者不显示。

    例如：视频输出画面为640×360，相对位置为TopLeft，Dx=4000，Dy=4000，则输出画面上看不到水印（文字水印亦是如此）。
    
  
  * 画面占比取值:相对输出视频分辨率宽度、高度的占比值，取值范围(0,1)，精确到小数点后四位。

    **注意**

    如果输出画面比例多变不可控，建议按照画面占比设置水印位置、尺寸相关参数。

    例如：0.9999。计算示例：Width/视频宽 = 0.1；Height/视频高 = 0.06；Dx/视频宽 = 0.02；Dy/视频高 = 0.03。
    
  

  

* **默认值** 

  * 水印宽、高都不设置：水印宽=视频输出画面宽×0.12，水印高按照水印原图比例等比缩放。

    
  
  * 宽、高设置其中一个：设置的一边按照设置的参数输出，另一边按照水印原图比例等比缩放。例如：Width=44，原图宽高比例是2：1，则Height=22。

    
  
  *
    宽、高都设置：则水印尺寸按照设置的参数输出。

    
  
  * Dx、Dy不设置时，则默认取值为0。

    
  

  




常用场景 
-------------------------

**文字水印动态替换** 

通常在短视频场景中，用户上传分享的视频在转码输出后，都会带有一个图片水印（通常是当前产品Logo）和文字水印（例如：视频原创者的ID或者昵称），用于宣示视频版权归属。

而对于不同用户上传分享的视频，用户的ID或者昵称并不相同，这就需要在对不同的视频转码时使用不同文字内容作为水印，视频点播支持在转码模板设置关联多水印后，通过提交媒体作接口发起转码并进行文字水印的内容替换，则可实现不同用户视频，文字水印内容不同的效果。更多信息，请参见[提交媒体转码作业](/intl.zh-CN/服务端API/媒体处理/发起处理/提交媒体转码作业.md)。

**效果示例** 

图片水印 + 文字水印，不同用户文字水印的内容不同。

![文字水印特效](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9969155061/p178312.png)

#### **实现方式** 

请参见[提交转码作业](/intl.zh-CN/服务端SDK/Java SDK/媒体处理.md) JavaSDK Demo。
