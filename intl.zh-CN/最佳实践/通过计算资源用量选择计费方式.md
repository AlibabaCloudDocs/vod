# 通过计算资源用量选择计费方式

不同的用量选择不用的计费方式可节省大量成本，本文介绍如何计算用量和如何选择计费方式。

## 案例

小王是一名创业者，带领团队自主研发了一个在线教育平台。他希望把视频存储在阿里云上，视频存量约2000个，占用存储空间近2T，每月预计新增视频200个，并新增存储约200G，课程视频的时长集中在25-35分钟，并且按照不同课程进行分类管理。为了保障各端的观看效果，计划为用户提供“标清480P”和“高清720P”两种清晰度。目前已有用户500人左右，每日平均视频观看次数2000次，在移动端和PC端观看次数比例大致为3:1。小王想要了解自己视频资源用量情况以及如何选择计费形式，性价比才能最优。

## 案例分析

从案例背景中可以看出小王需要用到的点播服务功能包括：视频上传与存储、视频转码。其中，视频播放产生的下行流量消耗与视频的观看次数、视频时长、码率大小有关。在计算用量前假设：

-   视频时长：根据课程视频的时长特点（集中在25-35分钟），视频时长按平均值30分钟计算。

-   清晰度分布：根据移动端和PC端的观看特点，移动端默认采用“标清480P”的清晰度，PC端默认采用“高清720P”的清晰度（忽略用户自行切换清晰度的情况）。

-   存储大小：案例中包含存量、增量两类视频。当进行转码操作后，原视频转码产生两种清晰度视频，因此，实际存储占用按3倍于原始视频大小进行计算。（忽略输出视频分辨率和码率对视频体积的影响，如果转码后的视频分辨率和码率高于原视频，则实际体积会变大。）


## 如何计算资源用量？

本案例计算得出的用量和费用都为预估值。

从案例中可以看出小王每年的资源用量消费（暂不考虑业务快速增长的情况）如下：

|项目|公式|用量|
|存储用量|存储用量：存量视频+增量视频-免费存储|-   存量视频：2048x3=6144GB
-   增量视频：200x3x12=7200GB
-   免费存储：50GB（存储大小在50G及以下免费使用）

那么，年平均存储用量：6144+7200-50=13294GB。|
|流量用量|流量用量：（观看次数x视频时长x视频码率大小）/8（byte）|-   移动端标清流量：1500（次数）x0.0009（标清码率：kbps）x3（平均时长：分钟）x60（分/秒）/8（byte=303.75GB/天
-   PC端高清流量：500（次数）x0.0015（高清码率：kbps）x30（平均时长：分钟）x60（分/秒）/8（byte）=168.75GB/天

那么，年平均流量用量：（303.75+168.75）x365=**172462.5**GB。|
|转码时长|转码时长：由转码输出视频的规格决定|-   存量标清视频：2000个x30分钟=60000分钟
-   存量高清视频：2000个x30分钟=60000分钟
-   增量标清视频：200个x30分钟x12=72000分钟
-   增量高清视频：200个x30分钟x12=72000分钟 |

## 如何选择计费方式？

本文将通过按量付费和预付费资源包两种计费方式，分别为小王计算平均每年的费用。

-   > 单价的变动请以阿里云官网发布的数据为准，详情请参见：[视频点播价格详情页](https://www.aliyun.com/price/product#vod/detail)。
-   > 资源包价格及购买，请单击[资源包](https://common-buy.aliyun.com/?&commodityCode=vodflowbag#/buy)。

|计费方式|计费公式|用量费用|
|按量付费|存储费用：存储单价x存储用量|-   存储单价：0.12元/GB/月
-   存储量：13294GB/年

那么，年平均存储费用：0.12元/GB/月x13294GB=**1595.28**元/年。|
|流量费用：流量单价x流量用量|-   流量单价：0.24元/GB
-   流量用量：172462.5GB

那么，年平均流量费用：0.24元/GBx172462.5GB=**41391**元/年。|
|转码费用：转码单价x转码时长|-   转码单价
    -   标清\(LD\)\(640x480\)：0.0217元/分钟
    -   高清\(SD\)\(1280x720\)：0.0326元/分钟
-   转码时长
    -   高清视频：60000+72000=132000分钟
    -   标清视频：60000+72000=132000分钟

那么，年平均转码费用：0.0217元/分钟x132000分+0.0326元/分钟x132000分=**7167.6**元/年。|
|预付费资源包|存储费用：存储包平均每年的费用|-   存储用量：13294GB=13TB
-   存储包规格：建议小王选2个5TB/年和3个1T/年的存储包，共计12951元。 |
|流量费用：流量包平均每年的费用|-   流量用量：172462.5GB=169TB/年
-   流量包规格：建议小王选1个200T/年的流量包，共计21800元。 |
|转码费用：转码资源包支持H.264的LD、SD、HD三种转码规格的抵扣，资源包时长指H.264LD的可抵扣时长，LD、SD、HD按1:1.5:3的比例抵扣。|-   转码时长：

    -   高清视频：132000分钟/年
    -   标清视频：132000分钟/年
那么，年平均转码时长：132000x1.5+132000=33万分钟

-   转码包规格：建议小王选1个50万分钟/年的转码时长包，共计5425元。 |

则两种计费方式的年平均费分别为：

-   按量付费：1595.28+41391+7167.6=**50153.88**元
-   预付费资源包：12951+21800+5425=**40176**元

通过以上两种计费方式得出的费用对比，可以看出：

-   选择预付费资源包的计费方式将为您节省大量成本，累计购买的资源包越多，享受的优惠越多。
-   此外，您也可以考虑组合预付费资源包和按量付费的方式计费，以实现最大的资源使用率和最低的成本。

