Download media files 
=========================================

You can download media files stored in ApsaraVideo VOD to on-premises disks or other storage devices. You can use the ApsaraVideo VOD console, client, or API operations to query the download URLs of various media files. This topic describes the media files, download URL types, download limits, and query methods. 

Media files 
--------------------------------

ApsaraVideo VOD may generate multiple types of media files, which include mezzanine files, transcoded stream files, video snapshot files, and uploaded image files. ApsaraVideo VOD allows you to query and download the following types of media files: 

* Audio and video

  * Mezzanine files uploaded to ApsaraVideo VOD

    
  
  * Transcoded stream files in a specified definition

    
  

  

* Image

  * Image files uploaded to ApsaraVideo VOD

    
  
  * Image files of thumbnail snapshots and image sprite snapshots automatically generated by ApsaraVideo VOD during snapshot processing

    
  
  * Image files of normal snapshots, image sprite snapshots, and original snapshots that compose sprite snapshots generated after you call the SubmitSnapshotJob operation. For more information, see [SubmitSnapshotJob](/intl.en-US/API Reference/Media processing/Process initiation/SubmitSnapshotJob.md).

    
  

  




Download URL types 
---------------------------------------

The media file download URLs that you can obtain include the Object Storage Service (OSS) source URLs and Alibaba Cloud CDN URLs. You are charged [media asset management](https://www.aliyun.com/price/detail/vod#module3) fees for downloads from OSS source URLs. These fees are the result of OSS outbound traffic. You are charged CDN traffic fees for downloads from CDN URLs. These fees are the result of [CDN acceleration](https://www.aliyun.com/price/product?#/cdn/detail). 

* Storage address

  * By default, the download URL of each media file is an OSS URL. For more information, see [Manage VOD resources](/intl.en-US/User Guide/Global settings/Manage VOD resources.md).

    
  
  * If a domain name for CDN is configured, the download URL of each media file is the CDN URL. You can forcibly return the OSS URL of a mezzanine file or a transcoded stream file as the download URL. To obtain the OSS URL, you can set the `OutputType` parameter to `oss` to obtain the download URL. For more information, see [GetMezzanineInfo](/intl.en-US/API Reference/Media asset management/Audio and video management/GetMezzanineInfo.md) and [GetPlayInfo](/intl.en-US/API Reference/Audio and video playback/GetPlayInfo.md). The download URL of a mezzanine file stored in an input bucket is the OSS URL even when a domain name for CDN is configured. The name of an input bucket starts with `in-`.

    
  

  

* CDN URL

  If a domain name for CDN is configured, the download URL of each media file is the CDN URL. For more information about how to configure a domain name for CDN, see [Add a domain name](/intl.en-US/User Guide/Domain management/Add a domain name.md).
  




Limits 
---------------------------

If media security services such as hotlink protection and video encryption are configured, media file download is limited even when the download URLs are obtained. 

* If the [access control](/intl.en-US/Developer Guide/Video security/Access control.md) service is configured, downloads from CDN URLs are limited by policies such as Referer-based hotlink protection and IP address blacklist or whitelist. The limits are the same as those for online playback. However, the limits do not apply to the downloads from OSS URLs.

  

* If video encryption is configured, all transcoded stream files that are downloaded are encrypted, no matter whether they are downloaded from OSS URLs or CDN URLs. You must decrypt the transcoded stream files for playback. For more information, see the "[Video encryption](/intl.en-US/Developer Guide/Video security/Overview.md)" section of the Overview topic.

  

* If private OSS storage is used, a download URL has a validity period. If a download URL expires, you must obtain it again. We recommend that you set a long validity period for download URLs.

  

* If URL signing is enabled for the domain name for CDN, a download URL has a validity period. If a download URL expires, you must obtain it again. We recommend that you set a long validity period for download URLs.

  




Use the console to obtain the download URLs 
----------------------------------------------------------------

* View download URLs

  * Audio and video mezzanine files and transcoded stream files:

    On the **[Video and Audio](https://vod.console.aliyun.com/#/media/video/list)** page in the ApsaraVideo VOD console, find the file that you want to manage and click **Manage** in the Actions column.![View download URLs](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/en-US/3928301161/p180272.png) 

    On the **Video URL** tab, click **Copy** in the Actions column to copy the download URL for a file. You can copy the download URL of the mezzanine file or the transcoded file in each definition.![Copy the download URL](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/en-US/3928301161/p180274.png)
    
  
  * Image files uploaded to ApsaraVideo VOD:

    On the **[Image](https://vod.console.aliyun.com/#/media/image/list)** page in the ApsaraVideo VOD console, find the file that you want to manage and click **Manage** in the Actions column.![Management](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/en-US/3928301161/p180276.png)
    
  
  * On the image details page, click **Copy** to copy the image URL.![Copy the download URL](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/en-US/3928301161/p180279.png)

    
  

  

* Export download URLs

  * Audio and video transcoded stream files:

    On the **[Video and Audio](https://vod.console.aliyun.com/#/media/video/list)** page in the ApsaraVideo VOD console, click the ![Export media URLs](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/en-US/3928301161/p180280.png)Export Media URL icon in the upper-right corner. The system exports the download URLs for the first 200 video and audio files transcoded in each definition based on the specified filter conditions.
    
  
  * Image files uploaded to ApsaraVideo VOD:

    On the **[Image](https://vod.console.aliyun.com/#/media/image/list)** page in the ApsaraVideo VOD console, click the ![Export media URLs](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/en-US/3928301161/p180280.png)Export Media URL icon in the upper-right corner. The system exports the download URLs for the first 100 images based on the specified filter conditions.
    
  

  




Use the API or SDK to obtain the download URLs 
-------------------------------------------------------------------

You can download audio and video mezzanine files, transcoded stream files, snapshot files that are automatically generated, and image files. You can use the following operations to obtain the download URLs of required files and download these URLs. 


|    Operation     |                                                                                                                                                                                                                                                                                                                                                                                                                    Description                                                                                                                                                                                                                                                                                                                                                                                                                     |                                                              Reference                                                              |
|------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------|
| GetMezzanineInfo | Queries the download URL of a mezzanine file. In the [Mezzanine](/intl.en-US/API Reference/Appendix/Basic data types.md) object that is returned, the `FileURL` parameter indicates the download URL of the mezzanine file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | [GetMezzanineInfo](/intl.en-US/API Reference/Media asset management/Audio and video management/GetMezzanineInfo.md) |
| GetPlayInfo      | Queries the streaming URL of a transcoded stream file. In the [PlayInfo](/intl.en-US/API Reference/Appendix/Basic data types.md) object that is returned, the `PlayURL` parameter indicates the streaming URL of the transcoded stream file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | [GetPlayInfo](/intl.en-US/API Reference/Audio and video playback/GetPlayInfo.md)                                    |
| GetVideoInfo     | Queries video information. In the [Video](/intl.en-US/API Reference/Appendix/Basic data types.md) object that is returned, the `CoverURL` parameter indicates the thumbnail URL, and the `Snapshots` parameter indicates a URL array of the snapshots that are automatically taken.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | [GetVideoInfo](/intl.en-US/API Reference/Media asset management/Audio and video management/GetVideoInfo.md)         |
| GetImageInfo     | Queries image information. In the [ImageInfo](/intl.en-US/API Reference/Appendix/Basic data types.md) object that is returned, the `URL` parameter indicates the image URL.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | [GetImageInfo](/intl.en-US/API Reference/Media asset management/Image management/GetImageInfo.md)                   |
| SearchMedia      | Queries media asset information. If the media asset type is set to video or audio, the media asset information is returned in the [Video](/intl.en-US/API Reference/Appendix/Media asset search protocol.md) or [Audio](/intl.en-US/API Reference/Appendix/Media asset search protocol.md) object. In the object, the `CoverURL` parameter indicates the thumbnail URL, the `Snapshots` parameter indicates a URL array of video snapshots, and the `SpriteSnapshots` parameter indicates a URL array of the sprite snapshots that are automatically taken. If the media asset type is set to image, the media asset information is returned in the [Image](/intl.en-US/API Reference/Appendix/Media asset search protocol.md) object. In the object, the `URL` parameter indicates the image URL. | [SearchMedia](/intl.en-US/API Reference/Media asset management/Media asset search/SearchMedia.md)                   |
| ListSnapshots    | Queries snapshot information. In the [MediaSnapshot](/intl.en-US/API Reference/Appendix/Basic data types.md) object that is returned, the `Snapshots` parameter indicates a URL array of the snapshots of the type specified by the `SnapshotType` parameter.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | [ListSnapshots](/intl.en-US/API Reference/Media asset management/Image management/ListSnapshots.md)                 |



**Call methods:** 

* We recommend that you use a server SDK to obtain media asset information by calling the API operation. This method is simpler and more efficient. For more information about server SDKs, see [Usage notes](/intl.en-US/Server SDK Reference/Usage notes.md). For more information about API operations, see the "`SDK example`" section of API references.

  

* You can send HTTP or HTTPS requests to obtain upload URLs and credentials. For more information, see [Common parameters](/intl.en-US/API Reference/Calling methods/Common parameters.md) and [Call examples](/intl.en-US/API Reference/Calling methods/Call Examples.md).

  




Client download 
------------------------------------

ApsaraVideo Player SDK provides the **download** feature to allow users to cache audio and video stream files on their mobile terminals and watch the streams offline. You can enable or disable this feature. The Normal and Encrypted download modes are supported. 

**Download settings** 

On the **[Download](https://vod.console.aliyun.com/#/settings/download)** page in the ApsaraVideo VOD console, you can set the Download Mode parameter. For more information, see [Configure offline download](/intl.en-US/User Guide/Domain management/Configure offline download.md). 

* Normal: In this mode, downloaded audio and video files are unencrypted. The files can be copied and can be played by using a player. Exercise caution when you set the download mode to Normal.

  

* Encrypted: In this mode, downloaded audio and video files are encrypted by using a key file. The files can be decrypted only by using the same key file. This protects the video copyright. You must use ApsaraVideo Player SDK to decrypt and play the downloaded audio and video files. The ApsaraVideo VOD console provides a tool for generating the private keys for encryption.

  




**ApsaraVideo Player SDK** 

Both ApsaraVideo Player SDK for iOS and ApsaraVideo Player SDK for Android support the secure download feature. For more information, see [Implementation](/intl.en-US/New Player SDK/ApsaraVideo Player SDK for iOS/Implementation.md) of ApsaraVideo Player SDK for iOS and [Implementation](/intl.en-US/New Player SDK/ApsaraVideo Player SDK for Android/Implementation.md) of ApsaraVideo Player SDK for Android.
