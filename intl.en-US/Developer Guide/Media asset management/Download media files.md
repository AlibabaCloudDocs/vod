Download media files 
=========================================

You can download media files stored in ApsaraVideo VOD to local disks or other storage devices. You can use the ApsaraVideo VOD console, client, or API operations to query the download URLs of various media files. This topic describes the media files, download URL types, download limits, and query methods.

Media files 
--------------------------------

ApsaraVideo VOD may generate multiple types of media files, which include mezzanine files, transcoded stream files, video snapshot files, and uploaded image files. ApsaraVideo VOD allows you to query and download the following types of media files: 

* Audio and video

  * Mezzanine files uploaded to ApsaraVideo VOD

    
  
  * Transcoded stream files in a specified definition

    
  

  

* Image

  * Image files uploaded to ApsaraVideo VOD

    
  
  * Image files of thumbnail snapshots and image sprite snapshots automatically generated by ApsaraVideo VOD during snapshot processing

    
  
  * Image files of normal snapshots, image sprite snapshots, and original snapshots that compose sprite snapshots generated after you call the [SubmitSnapshotJob](/intl.en-US/API Reference/Media processing/Initiate Process/SubmitSnapshotJob.md) operation

    
  

  




Download URL types 
---------------------------------------

The media file download URLs that you can obtain include the OSS source URLs and CDN URLs. You are charged [media asset management (storage) fees](https://www.aliyun.com/price/detail/vod#module3) for downloads from OSS source URLs. These fees are the result of OSS outbound traffic. You are charged [CDN traffic fees](https://www.aliyun.com/price/product?#/cdn/detail) for downloads from CDN URLs. These fees are the result of CDN acceleration.

* Storage address

  * By default, the download URL of each media file is an OSS URL. For more information, see [Manage VOD resources](/intl.en-US/User Guide/Global settings/Manage VOD resources.md).

    
  
  * If a domain name for CDN is configured, the download URL of each media file is the CDN URL. You can forcibly return the OSS URL of a mezzanine file or a transcoded stream file as the download URL. To obtain the OSS URL, you can set `OutputType` to `oss` to obtain the download URL. For more information, see [GetMezzanineInfo](/intl.en-US/API Reference/Media management/Audio&Video Management/GetMezzanineInfo.md) and [GetPlayInfo](/intl.en-US/API Reference/Video playback/GetPlayInfo.md). The download URL of a mezzanine file stored in an input bucket is the OSS URL even when a domain name for CDN is configured. The name of an input bucket starts with `in-`.

    
  

  

* CDN URL

  If a domain name for CDN is configured, the download URL of each media file is the CDN URL. For more information about how to configure a domain name for CDN, see [Add a domain name](/intl.en-US/User Guide/Domain management/Add a domain name.md).
  




Limits 
---------------------------

If media security services such as hotlink protection and video encryption are configured, media file download is limited even when the download URLs are obtained.

* If the [access control](/intl.en-US/Developer Guide/Video security/Access control.md) service is configured, downloads from CDN URLs are limited by policies such as Referer-based hotlink protection and IP address blacklist or whitelist. The limits are the same as those for online playback. However, the limits do not apply to the downloads from OSS URLs.

  

* If video encryption is configured, all transcoded stream files that are downloaded are encrypted, no matter whether they are downloaded from OSS URLs or CDN URLs. You must decrypt the transcoded stream files for playback. For more information, see the "[Video encryption](/intl.en-US/Developer Guide/Video security/Overview.md)" section of the Overview topic.

  

* If private OSS storage is used, a download URL has a validity period. If a download URL expires, you must obtain it again. We recommend that you set a long validity period for download URLs.

  

* If URL signing is enabled for the domain name for CDN, a download URL has a validity period. If a download URL expires, you must obtain it again. We recommend that you set a long validity period for download URLs.

  




Use the console to obtain the download URLs 
----------------------------------------------------------------

* View download URLs

  * Audio and video mezzanine files and transcoded stream files:

    On the **[Video and Audio](https://vod.console.aliyun.com/#/media/video/list)** page in the ApsaraVideo VOD console, click **Manage** in the Actions column.![View download URLs](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/en-US/3928301161/p180272.png)

    On the **Video URL** tab, click **Copy** in the Actions column to copy the download URL for a file. You can copy the original file and the download URL of the transcoded file in each definition.![Copy the download URL](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/en-US/3928301161/p180274.png)
    
  
  * Image files uploaded to ApsaraVideo VOD:

    On the **[Image](https://vod.console.aliyun.com/#/media/image/list)** page in the ApsaraVideo VOD console, click **Manage** in the Actions column.![Manage](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/en-US/3928301161/p180276.png)
    
  
  * On the **Image Details** page, click **Copy** to copy the image linking.![Copy the download URL](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/en-US/3928301161/p180279.png)

    
  

  

* Export download URLs

  * Audio and video transcoded stream files:

    On the **[Video and Audio](https://vod.console.aliyun.com/#/media/video/list)** page in the ApsaraVideo VOD console, click the Export Media URL icon in the upper-right corner to export download URLs for the first 200 videos and audios in each definition under the filter condition.![Export the download URL](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/en-US/3928301161/p180280.png)
    
  
  * Image files uploaded to ApsaraVideo VOD:

    On the **[Image](https://vod.console.aliyun.com/#/media/image/list)** page in the ApsaraVideo VOD console, click the ![Export media URLs](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/en-US/3928301161/p180280.png)Export Media URL icon in the upper-right corner to export download URLs for the first 100 images in each definition under the filter condition.
    
  

  




Use the API or SDK to obtain the download URLs 
-------------------------------------------------------------------

You can download audio and video mezzanine files, transcoded stream files, snapshot files that are automatically generated, and image files. You can use the following operations to obtain the download URLs of required files and download them.


|   Obtain information    |                                                                                                                                                                                                                                                                                                                                                                                        Description                                                                                                                                                                                                                                                                                                                                                                                         |                                                                 Reference                                                                  |
|-------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|
| Mezzanine file URL      | Obtains the download URL of a mezzanine file. In the [Mezzanine](/intl.en-US/API Reference/Appendix/Basic data types.md) object that is returned, `FileURL` indicates the download URL of the mezzanine file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | [Obtain mezzanine file information](/intl.en-US/API Reference/Media management/Audio&Video Management/GetMezzanineInfo.md) |
| Playback information    | Obtains the playback URL of a transcoded stream file. In the [PlayInfo](/intl.en-US/API Reference/Appendix/Basic data types.md) object that is returned, `PlayURL` indicates the playback URL of the transcoded stream file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | [Obtain video playback URLs](/intl.en-US/API Reference/Video playback/GetPlayInfo.md)                                      |
| Video information       | Obtains video information. In the [Video](/intl.en-US/API Reference/Appendix/Basic data types.md) object that is returned, `CoverURL` indicates the thumbnail URL, and `Snapshots` indicates a URL array of the snapshots that are automatically captured.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | [Obtain video information](/intl.en-US/API Reference/Media management/Audio&Video Management/GetVideoInfo.md)              |
| Image information       | Obtains image information. In the [ImageInfo](/intl.en-US/API Reference/Appendix/Basic data types.md) object that is returned, `URL` indicates the image URL.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | [Obtain image information](/intl.en-US/API Reference/Media management/Image Management/GetImageInfo.md)                    |
| Media asset Information | Obtains media asset information. If the media asset type is set to video or audio, the media asset information is returned in the [Video](/intl.en-US/API Reference/Appendix/Media asset search protocol.md) or [Audio](/intl.en-US/API Reference/Appendix/Media asset search protocol.md) object. In the object, `CoverURL` indicates the thumbnail URL, `Snapshots` indicates a URL array of video snapshots, and `SpriteSnapshots` indicates a URL array of the sprite snapshots that are automatically taken. If the media asset type is set to image, the media asset information is returned in the [Image](/intl.en-US/API Reference/Appendix/Media asset search protocol.md) object. In the object, `URL` indicates the image URL. | [Search for media information](/intl.en-US/API Reference/Media management/Media Search/SearchMedia.md)                     |
| Snapshot data           | Obtains snapshot information. In the [MediaSnapshot](/intl.en-US/API Reference/Appendix/Basic data types.md) object that is returned, `Snapshots` indicates a URL array of the snapshots of the type specified by `SnapshotType`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | [Obtain snapshot data](/intl.en-US/API Reference/Media management/Image Management/ListSnapshots.md)                       |



**Call methods:** 

* To obtain media asset information, we recommend that you use a server SDK by calling the API operations. This method is simpler and more efficient. For more information, see [Usage notes](/intl.en-US/Server SDK Reference/Instructions.md). For more information about API operations, see `SDK examples` for each API operation.

  

* For more information about how to generate HTTP or HTTPS requests, see [Common parameters](/intl.en-US/API Reference/Calling methods/Common parameters.md) and [Examples](/intl.en-US/API Reference/Calling methods/Call Examples.md).

  




Client download 
------------------------------------

ApsaraVideo Player SDK provides the **download** feature to allow users to cache audio and video stream files on their mobile terminals and watch the streams offline. You can enable or disable this feature. The Normal and Encrypted download modes are supported.

**Download** 

On the **[download settings](https://vod.console.aliyun.com/#/settings/download)** page in the ApsaraVideo VOD console, you can set Download Mode. For more information, see [Configure offline download](/intl.en-US/User Guide/Domain management/Configure offline download.md).

* Normal: In this mode, downloaded audio and video files are unencrypted. The files can be copied and can be played by using any player. Exercise caution when you set the download mode to Normal.

  

* Encrypted: In this mode, downloaded audio and video files are encrypted by using a key file. The files can be decrypted only by using the same key file. This protects the video copyright. You must use ApsaraVideo Player SDK to decrypt and play the downloaded audio and video files. The ApsaraVideo VOD console provides a tool for generating the private keys for encryption.

  




**ApsaraVideo Player SDK** 

Both ApsaraVideo Player SDK for iOS and ApsaraVideo Player SDK for Android support the secure download feature. For more information, see [Usage](/intl.en-US/New Player SDK/ApsaraVideo Player SDK for iOS/Features and usage.md) of ApsaraVideo Player SDK for iOS and [Usage](/intl.en-US/New Player SDK/ApsaraVideo Player SDK for Android/Features and usage.md) of ApsaraVideo Player SDK for Android.
